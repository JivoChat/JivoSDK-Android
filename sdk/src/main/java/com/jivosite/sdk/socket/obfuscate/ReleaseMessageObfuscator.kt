package com.jivosite.sdk.socket.obfuscateimport com.jivosite.sdk.model.pojo.socket.SocketMessageimport com.squareup.moshi.Moshi/** * Created on 21.01.2022. * * @author Alexander Tavtorkin (tavtorkin@jivosite.com) */class ReleaseMessageObfuscator constructor(private val moshi: Moshi) : MessageObfuscator {    override fun obfuscate(msg: String, socketMessage: SocketMessage): String {        return if (socketMessage.type == "text/plain") {            socketMessage.data?.let {                when (val length = it.length) {                    in 1..4 -> msg                    in 5..20 -> obfuscateData(socketMessage, it, 3 until length)                    else -> obfuscateData(socketMessage, it, 3..length - 4)                }            } ?: msg        } else msg    }    private fun obfuscateData(socketMessage: SocketMessage, data: String, intRange: IntRange): String {        return moshi.adapter(SocketMessage::class.java)            .toJson(socketMessage.copy(data = data.replaceRange(intRange, "***")))    }}